<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>周维度数据看板</title>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Bootstrap and other CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css" rel="stylesheet">
    <!-- flatpickr CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/material_blue.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/weekSelect/weekSelect.css">
    <!-- DataTables RowGroup CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/rowgroup/1.2.0/css/rowGroup.bootstrap5.min.css">
    <!-- DataTables FixedColumns CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/fixedcolumns/5.0.0/css/fixedColumns.bootstrap5.min.css">
    <link href="css/style.css" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- 顶部导航栏 -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">
                    <i class="fas fa-chart-line"></i> 周维度数据看板
                </a>
                <div class="navbar-nav ms-auto">
                    <div class="input-group">
                        <input type="text" class="form-control" id="weekPicker" placeholder="选择周" readonly style="width: 200px;">
                    </div>
                </div>
            </div>
        </nav>

        <div class="main-content">
            <div class="content-wrapper">
                <!-- 左侧数据领域导航 -->
                <div class="domain-sidebar">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title text-center mb-4">数据领域</h5>
                            <div class="nav flex-column nav-pills" id="domainTabs" role="tablist" aria-orientation="vertical">
                                <button class="nav-link active" data-domain="transaction" role="tab" aria-selected="true" title="查看交易数据">
                                    <i class="fas fa-shopping-cart" aria-hidden="true"></i> 交易数据
                                </button>
                                <button class="nav-link" data-domain="activity" role="tab" aria-selected="false" title="查看活动数据">
                                    <i class="fas fa-chart-line" aria-hidden="true"></i> 活动数据
                                </button>
                                <button class="nav-link" data-domain="rtb" role="tab" aria-selected="false" title="查看RTB投放数据">
                                    <i class="fas fa-bullhorn" aria-hidden="true"></i> RTB投放
                                </button>
                                <button class="nav-link" data-domain="supply" role="tab" aria-selected="false" title="查看供给数据">
                                    <i class="fas fa-warehouse" aria-hidden="true"></i> 供给表现
                                </button>
                                <button class="nav-link" data-domain="user" role="tab" aria-selected="false" title="查看用户数据">
                                    <i class="fas fa-users" aria-hidden="true"></i> 用户数据
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 主要内容区域 -->
                <div class="main-panel">
                    <!-- 平台切换Tab -->
                    <div class="platform-tabs-container">
                        <div class="card">
                            <div class="card-body">
                                <ul class="nav nav-pills" id="platformTabs" role="tablist">
                                     <li class="nav-item" role="presentation">
                                         <button class="nav-link active" data-platform="all" role="tab" aria-selected="true" title="查看全平台数据">全平台</button>
                                     </li>
                                     <li class="nav-item" role="presentation">
                                         <button class="nav-link" data-platform="meituan" role="tab" aria-selected="false" title="查看美团数据">美团</button>
                                     </li>
                                     <li class="nav-item" role="presentation">
                                         <button class="nav-link" data-platform="jd" role="tab" aria-selected="false" title="查看京东到家数据">京东到家</button>
                                     </li>
                                     <li class="nav-item" role="presentation">
                                         <button class="nav-link" data-platform="ele" role="tab" aria-selected="false" title="查看饿了么数据">饿了么</button>
                                     </li>
                                     <li class="nav-item" role="presentation">
                                         <button class="nav-link" data-platform="duodian" role="tab" aria-selected="false" title="查看多点数据">多点</button>
                                     </li>
                                     <li class="nav-item" role="presentation">
                                         <button class="nav-link" data-platform="taoxianda" role="tab" aria-selected="false" title="查看淘鲜达数据">淘鲜达</button>
                                     </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- 交易领域专属内容 -->
                    <div id="transaction-content">
                        <!-- 指标卡片区域 -->
                        <div class="row g-4" id="metricCards">
                            <!-- GMV YTD 指标卡 -->
                            <div class="col-md-4">
                                <div class="card metric-card h-100">
                                    <div class="card-body">
                                        <h5 class="card-title">YTD</h5>
                                        <div class="metric-main">
                                            <p class="metric-value" id="gmvYTD">-</p>
                                        </div>
                                        <div class="metric-secondary">
                                            <span class="metric-label">年同比</span>
                                            <span class="metric-value" id="gmvYOY">-</span>
                                        </div>
                                        <div class="metric-row mt-3">
                                            <span class="metric-label">目标达成率</span>
                                            <div class="progress">
                                                <div class="progress-bar" id="gmvTargetBar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                                    <span id="gmvTarget">-</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- GMV MTD 指标卡 -->
                            <div class="col-md-4">
                                <div class="card metric-card h-100">
                                    <div class="card-body">
                                        <h5 class="card-title">MTD</h5>
                                        <div class="metric-main">
                                            <p class="metric-value" id="gmvMTD">-</p>
                                        </div>
                                        <div class="metric-secondary">
                                            <span class="metric-label">年同比</span>
                                            <span class="metric-value" id="gmvMTDYOY">-</span>
                                        </div>
                                        <div class="metric-row mt-3">
                                            <span class="metric-label">目标达成率</span>
                                            <div class="progress">
                                                <div class="progress-bar" id="gmvMTDTargetBar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                                    <span id="gmvMTDTarget">-</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- GMV Week 指标卡 -->
                            <div class="col-md-4">
                                <div class="card metric-card h-100">
                                    <div class="card-body">
                                        <h5 class="card-title" id="gmvWeekTitle">Week 20</h5>
                                        <div class="metric-main">
                                             <p class="metric-value" id="gmvWeek">-</p>
                                        </div>
                                         <div class="metric-secondary">
                                            <span class="metric-label">年同比</span>
                                            <span class="metric-value" id="gmvWeekYOY">-</span>
                                        </div>
                                        <div class="metric-secondary">
                                            <span class="metric-label">周环比</span>
                                            <span class="metric-value" id="gmvWOW">-</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- GMV趋势图 & 多维表现 -->
                        <div class="row g-4 mt-1">
                            <div class="col-lg-12">
                               <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">GMV趋势</h5>
                                        <div class="chart-wrapper">
                                            <canvas id="gmvTrendChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="product-performance-section">
                                    <div class="card">
                                        <div class="card-header d-flex justify-content-between align-items-center">
                                            <h5 class="mb-0">多维表现</h5>
                                            <div class="d-flex align-items-center">
                                                <label for="dimensionTypeSelector" class="form-label me-2 mb-0">维度类型:</label>
                                                <select class="form-select w-auto" id="dimensionTypeSelector" aria-label="选择维度类型">
                                                    <option value="subBrand" selected>子品牌</option>
                                                    <option value="productLine">品线</option>
                                                    <option value="channelType">渠道类型</option>
                                                    <option value="region">大区</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <div class="row g-4">
                                                <!-- Top Left: Pie Chart -->
                                                <div class="col-md-5">
                                                    <div class="chart-wrapper" style="height: 400px;">
                                                        <canvas id="dimensionPieChart"></canvas>
                                                    </div>
                                                </div>
                                                <!-- Top Right: Combo Chart -->
                                                <div class="col-md-7">
                                                    <div class="chart-wrapper" style="height: 400px;">
                                                        <canvas id="dimensionComboChart"></canvas>
                                                    </div>
                                                </div>
                                                <!-- Bottom: Data Table -->
                                                <div class="col-12 mt-4">
                                                    <div>
                                                         <table class="table table-hover table-bordered" id="dimensionDataTable" style="width:100%;">
                                                             <!-- a new header will be generated dynamically -->
                                                         </table>
                                                     </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 通用领域内容 -->
                    <div id="generic-content" style="display: none;">
                        <div class="row g-4" id="genericMetricCards">
                            <!-- 通用指标卡将通过JavaScript动态生成 -->
                        </div>
                        <div class="row g-4 mt-1">
                            <div class="col-md-7">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h5 class="card-title d-flex justify-content-between">
                                            <span>趋势分析</span>
                                            <button class="btn btn-sm btn-outline-secondary" id="chartTypeToggle" title="切换图表类型">
                                                 <i class="fas fa-chart-line" aria-hidden="true"></i>
                                            </button>
                                        </h5>
                                        <div class="chart-wrapper">
                                            <canvas id="trendChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-5">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h5 class="card-title">详细数据</h5>
                                        <div class="table-responsive">
                                            <table class="table table-hover" id="dataTable"></table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 加载动画 -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">加载中...</span>
        </div>
    </div>
    
    <!-- JS依赖 -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/rowgroup/1.2.0/js/dataTables.rowGroup.min.js"></script>
    <script src="https://cdn.datatables.net/fixedcolumns/5.0.0/js/dataTables.fixedColumns.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.10/dayjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.10/plugin/isoWeek.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.10/locale/zh-cn.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/zh.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/weekSelect/weekSelect.js"></script>
    
    <!-- 应用代码 -->
    <script src="js/mockData.js"></script>
    <script src="js/app.js"></script>
</body>
</html> 